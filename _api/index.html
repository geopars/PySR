
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>API Reference - PySR</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://ai.damtp.cam.ac.uk/pysr" title="PySR" class="md-header__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PySR
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ai.damtp.cam.ac.uk/pysr" title="PySR" class="md-nav__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    PySR
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Toy Examples with Code
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tuning and Workflow Tips
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features and Options
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../papers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customization
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.sympy" class="md-nav__link">
    <span class="md-ellipsis">
      sympy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex" class="md-nav__link">
    <span class="md-ellipsis">
      latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.jax" class="md-nav__link">
    <span class="md-ellipsis">
      jax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex_table" class="md-nav__link">
    <span class="md-ellipsis">
      latex_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expression-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Expression Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expression Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.ExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.TemplateExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      TemplateExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.ParametricExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ParametricExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      AbstractExpressionSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AbstractExpressionSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec.create_exports" class="md-nav__link">
    <span class="md-ellipsis">
      create_exports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec.julia_expression_spec" class="md-nav__link">
    <span class="md-ellipsis">
      julia_expression_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logger-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Logger Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logger Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.TensorBoardLoggerSpec" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardLoggerSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec" class="md-nav__link">
    <span class="md-ellipsis">
      AbstractLoggerSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AbstractLoggerSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.create_logger" class="md-nav__link">
    <span class="md-ellipsis">
      create_logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.write_hparams" class="md-nav__link">
    <span class="md-ellipsis">
      write_hparams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p><code>PySRRegressor</code> has many options for controlling a symbolic regression search.
Let's look at them below.</p>
<p>PARAMSKEY</p>
<h2 id="pysrregressor-functions">PySRRegressor Functions<a class="headerlink" href="#pysrregressor-functions" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">Xresampled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variable_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complexity_of_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Search for equations to fit the dataset and store them in <code>self.equations_</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data of shape (n_samples, n_features).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target values of shape (n_samples,) or (n_samples, n_targets).
Will be cast to X's dtype if necessary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Xresampled</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resampled training data, of shape (n_resampled, n_features),
to generate a denoised data on. This
will be used as the training data, rather than <code>X</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight array of the same shape as <code>y</code>.
Each element is how to weight the mean-square-error loss
for that particular element of <code>y</code>. Alternatively,
if a custom <code>loss</code> was set, it will can be used
in arbitrary ways.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_names</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of names for the variables, rather than "x0", "x1", etc.
If <code>X</code> is a pandas dataframe, the column names will be used
instead of <code>variable_names</code>. Cannot contain spaces or special
characters. Avoid variable names which are also
function names in <code>sympy</code>, such as "N".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_units</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of units for each variable in <code>X</code>. Each unit should be
a string representing a Julia expression. See DynamicQuantities.jl
https://symbolicml.org/DynamicQuantities.jl/dev/units/ for more
information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_units</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similar to <code>X_units</code>, but as a unit for the target variable, <code>y</code>.
If <code>y</code> is a matrix, a list of units should be passed. If <code>X_units</code>
is given but <code>y_units</code> is not, then <code>y_units</code> will be arbitrary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>expression_spec</code> is a <code>ParametricExpressionSpec</code>, then this
argument should be a list of integers representing the category
of each sample.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted estimator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2154" name="__codelineno-0-2154"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>    <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>    <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>    <span class="n">Xresampled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>    <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>    <span class="n">variable_names</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>    <span class="n">complexity_of_variables</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>    <span class="n">X_units</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>    <span class="n">y_units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>    <span class="n">category</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PySRRegressor&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a><span class="sd">    Search for equations to fit the dataset and store them in `self.equations_`.</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a><span class="sd">    X : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a><span class="sd">        Training data of shape (n_samples, n_features).</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a><span class="sd">    y : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a><span class="sd">        Target values of shape (n_samples,) or (n_samples, n_targets).</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a><span class="sd">        Will be cast to X&#39;s dtype if necessary.</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a><span class="sd">    Xresampled : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a><span class="sd">        Resampled training data, of shape (n_resampled, n_features),</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a><span class="sd">        to generate a denoised data on. This</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><span class="sd">        will be used as the training data, rather than `X`.</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="sd">    weights : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a><span class="sd">        Weight array of the same shape as `y`.</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">        Each element is how to weight the mean-square-error loss</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">        for that particular element of `y`. Alternatively,</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">        if a custom `loss` was set, it will can be used</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">        in arbitrary ways.</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">    variable_names : list[str]</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">        A list of names for the variables, rather than &quot;x0&quot;, &quot;x1&quot;, etc.</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">        If `X` is a pandas dataframe, the column names will be used</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><span class="sd">        instead of `variable_names`. Cannot contain spaces or special</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">        characters. Avoid variable names which are also</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="sd">        function names in `sympy`, such as &quot;N&quot;.</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="sd">    X_units : list[str]</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">        A list of units for each variable in `X`. Each unit should be</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="sd">        a string representing a Julia expression. See DynamicQuantities.jl</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">        https://symbolicml.org/DynamicQuantities.jl/dev/units/ for more</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">        information.</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><span class="sd">    y_units : str | list[str]</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">        Similar to `X_units`, but as a unit for the target variable, `y`.</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="sd">        If `y` is a matrix, a list of units should be passed. If `X_units`</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">        is given but `y_units` is not, then `y_units` will be arbitrary.</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">    category : list[int]</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">        If `expression_spec` is a `ParametricExpressionSpec`, then this</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">        argument should be a list of integers representing the category</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">        of each sample.</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">    self : object</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="sd">        Fitted estimator.</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>    <span class="c1"># Init attributes that are not specified in BaseEstimator</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;julia_state_stream_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;julia_state_stream_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a>                <span class="s2">&quot;The discovered expressions are being reset. &quot;</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>                <span class="s2">&quot;Please set `warm_start=True` if you wish to continue &quot;</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a>                <span class="s2">&quot;to start a search where you left off.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>            <span class="p">)</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">julia_state_stream_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">julia_options_stream_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">complexity_of_variables_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_units_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_units_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_equation_file</span><span class="p">()</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_clear_equation_file_contents</span><span class="p">()</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>    <span class="n">runtime_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_modify_params</span><span class="p">()</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>    <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a>        <span class="k">assert</span> <span class="n">Xresampled</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec</span><span class="p">,</span> <span class="n">ParametricExpressionSpec</span><span class="p">):</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>        <span class="k">assert</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a>    <span class="c1"># TODO: Put `category` here</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>    <span class="p">(</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a>        <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_set_fit_params</span><span class="p">(</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>        <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>    <span class="p">)</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">batching</span><span class="p">:</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>            <span class="s2">&quot;Note: you are running with more than 10,000 datapoints. &quot;</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>            <span class="s2">&quot;You should consider turning on batching (https://ai.damtp.cam.ac.uk/pysr/options/#batching). &quot;</span>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>            <span class="s2">&quot;You should also reconsider if you need that many datapoints. &quot;</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>            <span class="s2">&quot;Unless you have a large amount of noise (in which case you &quot;</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a>            <span class="s2">&quot;should smooth your dataset first), generally &lt; 10,000 datapoints &quot;</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a>            <span class="s2">&quot;is enough to find a functional form with symbolic regression. &quot;</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>            <span class="s2">&quot;More datapoints will lower the search speed.&quot;</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>        <span class="p">)</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>    <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>  <span class="c1"># For np random</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>    <span class="n">seed</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># For julia random</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec</span><span class="p">,</span> <span class="n">ParametricExpressionSpec</span><span class="p">):</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>        <span class="n">parametric_expression_deprecation_warning</span><span class="p">(</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec</span><span class="o">.</span><span class="n">max_parameters</span><span class="p">,</span> <span class="n">variable_names</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>        <span class="p">)</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>    <span class="c1"># Pre transformations (feature selection and denoising)</span>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">variable_names</span><span class="p">,</span> <span class="n">complexity_of_variables</span><span class="p">,</span> <span class="n">X_units</span><span class="p">,</span> <span class="n">y_units</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_transform_training_data</span><span class="p">(</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>            <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>            <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>            <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>            <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>            <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>            <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>            <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>            <span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>        <span class="p">)</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>    <span class="p">)</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>    <span class="c1"># Assertion checks</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>    <span class="n">use_custom_variable_names</span> <span class="o">=</span> <span class="n">variable_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>    <span class="c1"># TODO: this is always true.</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>    <span class="n">_check_assertions</span><span class="p">(</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>        <span class="n">use_custom_variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>    <span class="p">)</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>    <span class="c1"># Initially, just save model parameters, so that</span>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>    <span class="c1"># it can be loaded from an early exit:</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_equation_file</span><span class="p">:</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">()</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>    <span class="c1"># Perform the search:</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">runtime_params</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>    <span class="c1"># Then, after fit, we save again, so the pickle file contains</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>    <span class="c1"># the equations:</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_equation_file</span><span class="p">:</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">()</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Predict y from input X using the equation chosen by <code>model_selection</code>.</p>
<p>You may see what equation is used by printing this object. X should
have the same columns as the training data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data of shape <code>(n_samples, n_features)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you want to compute the output of an expression using a
particular row of <code>self.equations_</code>, you may specify the index here.
For multiple output equations, you must pass a list of indices
in the same order.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>expression_spec</code> is a <code>ParametricExpressionSpec</code>, then this
argument should be a list of integers representing the category
of each sample in <code>X</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>y_predicted</code></td>            <td>
                  <code>ndarray of shape (n_samples, nout_)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values predicted by substituting <code>X</code> into the fitted symbolic
regression model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raises if the <code>best_equation</code> cannot be evaluated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>    <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a>    <span class="n">category</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="sd">    Predict y from input X using the equation chosen by `model_selection`.</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><span class="sd">    You may see what equation is used by printing this object. X should</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="sd">    have the same columns as the training data.</span>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">    X : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">        Training data of shape `(n_samples, n_features)`.</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><span class="sd">        If you want to compute the output of an expression using a</span>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><span class="sd">        particular row of `self.equations_`, you may specify the index here.</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a><span class="sd">        For multiple output equations, you must pass a list of indices</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><span class="sd">        in the same order.</span>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><span class="sd">    category : ndarray | None</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><span class="sd">        If `expression_spec` is a `ParametricExpressionSpec`, then this</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><span class="sd">        argument should be a list of integers representing the category</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a><span class="sd">        of each sample in `X`.</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a><span class="sd">    y_predicted : ndarray of shape (n_samples, nout_)</span>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="sd">        Values predicted by substituting `X` into the fitted symbolic</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a><span class="sd">        regression model.</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a><span class="sd">    ------</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a><span class="sd">        Raises if the `best_equation` cannot be evaluated.</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>    <span class="n">check_is_fitted</span><span class="p">(</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selection_mask_&quot;</span><span class="p">,</span> <span class="s2">&quot;feature_names_in_&quot;</span><span class="p">,</span> <span class="s2">&quot;nout_&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>    <span class="p">)</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>    <span class="c1"># When X is an numpy array or a pandas dataframe with a RangeIndex,</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>    <span class="c1"># the self.feature_names_in_ generated during fit, for the same X,</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>    <span class="c1"># will cause a warning to be thrown during _validate_data.</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>    <span class="c1"># To avoid this, convert X to a dataframe, apply the selection mask,</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>    <span class="c1"># and then set the column/feature_names of X to be equal to those</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>    <span class="c1"># generated during fit.</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">check_array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="c1"># RangeIndex enforces column order allowing columns to</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>            <span class="c1"># be correctly filtered with self.selection_mask_</span>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span><span class="p">]]</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>        <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_names_in_</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>    <span class="c1"># Without feature information, CallableEquation/lambda_format equations</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>    <span class="c1"># require that the column order of X matches that of the X used during</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>    <span class="c1"># the fitting process. _validate_data removes this feature information</span>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>    <span class="c1"># when it converts the dataframe to an np array. Thus, to ensure feature</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>    <span class="c1"># order is preserved after conversion, the dataframe columns must be</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>    <span class="c1"># reordered/reindexed to match those of the transformed (denoised and</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>    <span class="c1"># feature selected) X in fit.</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data_X</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">evaluates_in_julia</span><span class="p">:</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>        <span class="c1"># Julia wants the right dtype</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_precision_mapped_dtype</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>    <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>        <span class="n">offset_for_julia_indexing</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>            <span class="n">jl_array</span><span class="p">((</span><span class="n">category</span> <span class="o">+</span> <span class="n">offset_for_julia_indexing</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)),</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>        <span class="p">)</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">()</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>                <span class="p">[</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>                    <span class="n">cast</span><span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">eq</span><span class="p">[</span><span class="s2">&quot;lambda_format&quot;</span><span class="p">](</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>                    <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>                <span class="p">],</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>            <span class="p">)</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>            <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;lambda_format&quot;</span><span class="p">](</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>            <span class="s2">&quot;Failed to evaluate the expression. &quot;</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>            <span class="s2">&quot;If you are using a custom operator, make sure to define it in `extra_sympy_mappings`, &quot;</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>            <span class="s2">&quot;e.g., `model.set_params(extra_sympy_mappings={&#39;inv&#39;: lambda x: 1/x})`, where &quot;</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>            <span class="s2">&quot;`lambda x: 1/x` is a valid SymPy function defining the operator. &quot;</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>            <span class="s2">&quot;You can then run `model.refresh()` to re-load the expressions.&quot;</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">error</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_file</span><span class="p">(</span><span class="n">equation_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">run_directory</span><span class="p">,</span> <span class="n">binary_operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unary_operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_features_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feature_names_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selection_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pysr.PySRRegressor.from_file" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Create a model from a saved model checkpoint or equation file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>run_directory</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory containing outputs from a previous run.
This is of the form <code>[output_directory]/[run_id]</code>.
Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binary_operators</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The same binary operators used when creating the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unary_operators</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The same unary operators used when creating the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_features_in</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of features passed to the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_names_in</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the features passed to the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_mask</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If using <code>select_k_features</code>, you must pass <code>model.selection_mask_</code> here.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nout</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of outputs of the model.
Not needed if loading from a pickle file.
Default is <code>1</code>.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**pysr_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any other keyword arguments to initialize the PySRRegressor object.
These will overwrite those stored in the pickle file.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>model</code></td>            <td>
                  <code><span title="pysr.sr.PySRRegressor">PySRRegressor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model with fitted equations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>    <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>    <span class="n">equation_file</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Deprecated</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>    <span class="n">run_directory</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="n">binary_operators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>    <span class="n">unary_operators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>    <span class="n">n_features_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>    <span class="n">feature_names_in</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>    <span class="n">selection_mask</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>    <span class="n">nout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>    <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PySRRegressor&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">    Create a model from a saved model checkpoint or equation file.</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">    run_directory : str</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        The directory containing outputs from a previous run.</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">        This is of the form `[output_directory]/[run_id]`.</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">        Default is `None`.</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">    binary_operators : list[str]</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">        The same binary operators used when creating the model.</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">    unary_operators : list[str]</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        The same unary operators used when creating the model.</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">    n_features_in : int</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        Number of features passed to the model.</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">    feature_names_in : list[str]</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">        Names of the features passed to the model.</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">    selection_mask : NDArray[np.bool_]</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        If using `select_k_features`, you must pass `model.selection_mask_` here.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">    nout : int</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        Number of outputs of the model.</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        Default is `1`.</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">    **pysr_kwargs : dict</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">        Any other keyword arguments to initialize the PySRRegressor object.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        These will overwrite those stored in the pickle file.</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">    model : PySRRegressor</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">        The model with fitted equations.</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>    <span class="k">if</span> <span class="n">equation_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>            <span class="s2">&quot;Passing `equation_file` is deprecated and no longer compatible with &quot;</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>            <span class="s2">&quot;the most recent versions of PySR&#39;s backend. Please pass `run_directory` &quot;</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>            <span class="s2">&quot;instead, which contains all checkpoint files.&quot;</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>        <span class="p">)</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>    <span class="n">pkl_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;checkpoint.pkl&quot;</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>    <span class="k">if</span> <span class="n">pkl_filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>        <span class="n">pysr_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to load model from </span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>        <span class="k">assert</span> <span class="n">binary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>        <span class="k">assert</span> <span class="n">unary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>        <span class="k">assert</span> <span class="n">n_features_in</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;PySRRegressor&quot;</span><span class="p">,</span> <span class="n">pkl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>        <span class="c1"># Update any parameters if necessary, such as</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>        <span class="c1"># extra_sympy_mappings:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>        <span class="k">if</span> <span class="s2">&quot;equations_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="vm">__dict__</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">equations_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>            <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">expression_spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>                <span class="s2">&quot;Loading model from checkpoint file with a non-default expression spec &quot;</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>                <span class="s2">&quot;is not fully supported as it relies on dynamic objects. This may result in unexpected behavior.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>            <span class="p">)</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>        <span class="k">return</span> <span class="n">model</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>        <span class="n">pysr_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>            <span class="sa">f</span><span class="s2">&quot;Checkpoint file </span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2"> does not exist. &quot;</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>            <span class="s2">&quot;Attempting to recreate model from scratch...&quot;</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>        <span class="p">)</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>        <span class="n">csv_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;hall_of_fame.csv&quot;</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>        <span class="n">csv_filename_bak</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;hall_of_fame.csv.bak&quot;</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">csv_filename</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">csv_filename_bak</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>                <span class="sa">f</span><span class="s2">&quot;Hall of fame file `</span><span class="si">{</span><span class="n">csv_filename</span><span class="si">}</span><span class="s2">` or `</span><span class="si">{</span><span class="n">csv_filename_bak</span><span class="si">}</span><span class="s2">` does not exist. &quot;</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>                <span class="s2">&quot;Please pass a `run_directory` containing a valid checkpoint file.&quot;</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>            <span class="p">)</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>        <span class="k">assert</span> <span class="n">binary_operators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">unary_operators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>        <span class="k">assert</span> <span class="n">n_features_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>            <span class="n">binary_operators</span><span class="o">=</span><span class="n">binary_operators</span><span class="p">,</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>            <span class="n">unary_operators</span><span class="o">=</span><span class="n">unary_operators</span><span class="p">,</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>            <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>        <span class="p">)</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="n">model</span><span class="o">.</span><span class="n">nout_</span> <span class="o">=</span> <span class="n">nout</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="n">model</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">=</span> <span class="n">n_features_in</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="k">if</span> <span class="n">feature_names_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>            <span class="n">model</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">)]</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>            <span class="p">)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>            <span class="n">model</span><span class="o">.</span><span class="n">display_feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">_subscriptify</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">)]</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>            <span class="p">)</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_in</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_features_in</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>            <span class="n">model</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">feature_names_in</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>            <span class="n">model</span><span class="o">.</span><span class="n">display_feature_names_in_</span> <span class="o">=</span> <span class="n">feature_names_in</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="k">if</span> <span class="n">selection_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>            <span class="n">model</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>            <span class="n">model</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="n">selection_mask</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>        <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">run_directory</span><span class="o">=</span><span class="n">run_directory</span><span class="p">)</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.sympy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sympy</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.sympy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return sympy representation of the equation(s) chosen by <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>str, list[str] of length nout_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SymPy representation of the best equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2447" name="__codelineno-0-2447"></a><span class="k">def</span><span class="w"> </span><span class="nf">sympy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a><span class="sd">    Return sympy representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a><span class="sd">    best_equation : str, list[str] of length nout_</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a><span class="sd">        SymPy representation of the best equation.</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_sympy</span><span class="p">:</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support sympy export.&quot;</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>        <span class="p">)</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;sympy_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;sympy_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.latex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.latex" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return latex representation of the equation(s) chosen by <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of significant figures shown in the LaTeX
representation.
Default is <code>3</code>.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>str or list[str] of length nout_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LaTeX expression of the best equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2477" name="__codelineno-0-2477"></a><span class="k">def</span><span class="w"> </span><span class="nf">latex</span><span class="p">(</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a><span class="sd">    Return latex representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a><span class="sd">    precision : int</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a><span class="sd">        The number of significant figures shown in the LaTeX</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a><span class="sd">        representation.</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="sd">        Default is `3`.</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><span class="sd">    best_equation : str or list[str] of length nout_</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a><span class="sd">        LaTeX expression of the best equation.</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_latex</span><span class="p">:</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support latex export.&quot;</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>        <span class="p">)</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>    <span class="n">sympy_representation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sympy</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sympy_representation</span><span class="p">:</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>            <span class="n">latex</span> <span class="o">=</span> <span class="n">sympy2latex</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">latex</span><span class="p">)</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>        <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>    <span class="k">return</span> <span class="n">sympy2latex</span><span class="p">(</span><span class="n">sympy_representation</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.pytorch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pytorch</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.pytorch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return pytorch representation of the equation(s) chosen by <code>model_selection</code>.</p>
<p>Each equation (multiple given if there are multiple outputs) is a PyTorch module
containing the parameters as trainable attributes. You can use the module like
any other PyTorch module: <code>module(X)</code>, where <code>X</code> is a tensor with the same
column ordering as trained with.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PyTorch module representing the expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2551" name="__codelineno-0-2551"></a><span class="k">def</span><span class="w"> </span><span class="nf">pytorch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><span class="sd">    Return pytorch representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><span class="sd">    Each equation (multiple given if there are multiple outputs) is a PyTorch module</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a><span class="sd">    containing the parameters as trainable attributes. You can use the module like</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><span class="sd">    any other PyTorch module: `module(X)`, where `X` is a tensor with the same</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><span class="sd">    column ordering as trained with.</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a><span class="sd">    best_equation : torch.nn.Module</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a><span class="sd">        PyTorch module representing the expression.</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_torch</span><span class="p">:</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support torch export.&quot;</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>        <span class="p">)</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">output_torch_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;torch_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;torch_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.jax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jax</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.jax" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return jax representation of the equation(s) chosen by <code>model_selection</code>.</p>
<p>Each equation (multiple given if there are multiple outputs) is a dictionary
containing {"callable": func, "parameters": params}. To call <code>func</code>, pass
func(X, params). This function is differentiable using <code>jax.grad</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of callable jax function in "callable" key,
and jax array of parameters as "parameters" key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><span class="k">def</span><span class="w"> </span><span class="nf">jax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="sd">    Return jax representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a><span class="sd">    Each equation (multiple given if there are multiple outputs) is a dictionary</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><span class="sd">    containing {&quot;callable&quot;: func, &quot;parameters&quot;: params}. To call `func`, pass</span>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a><span class="sd">    func(X, params). This function is differentiable using `jax.grad`.</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a><span class="sd">    best_equation : dict[str, Any]</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a><span class="sd">        Dictionary of callable jax function in &quot;callable&quot; key,</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a><span class="sd">        and jax array of parameters as &quot;parameters&quot; key.</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_jax</span><span class="p">:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support jax export.&quot;</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>        <span class="p">)</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">output_jax_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;jax_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;jax_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.latex_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latex_table</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;equation&#39;</span><span class="p">,</span> <span class="s1">&#39;complexity&#39;</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">])</span></code>

<a href="#pysr.PySRRegressor.latex_table" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Create a LaTeX/booktabs table for all, or some, of the equations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>indices</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="list">list</span>[<span title="list">list</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular subset of equations from
<code>self.equations_</code>, give the row numbers here. By default,
all equations will be used. If there are multiple output
features, then pass a list of lists.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of significant figures shown in the LaTeX
representations.
Default is <code>3</code>.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which columns to include in the table.
Default is <code>["equation", "complexity", "loss", "score"]</code>.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;equation&#39;, &#39;complexity&#39;, &#39;loss&#39;, &#39;score&#39;]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>latex_table_str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string that will render a table in LaTeX of the equations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="k">def</span><span class="w"> </span><span class="nf">latex_table</span><span class="p">(</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a>    <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a>    <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;equation&quot;</span><span class="p">,</span> <span class="s2">&quot;complexity&quot;</span><span class="p">,</span> <span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">],</span>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a LaTeX/booktabs table for all, or some, of the equations.</span>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">    indices : list[int] | list[list[int]]</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">        If you wish to select a particular subset of equations from</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a><span class="sd">        `self.equations_`, give the row numbers here. By default,</span>
<a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="sd">        all equations will be used. If there are multiple output</span>
<a id="__codelineno-0-2697" name="__codelineno-0-2697"></a><span class="sd">        features, then pass a list of lists.</span>
<a id="__codelineno-0-2698" name="__codelineno-0-2698"></a><span class="sd">    precision : int</span>
<a id="__codelineno-0-2699" name="__codelineno-0-2699"></a><span class="sd">        The number of significant figures shown in the LaTeX</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a><span class="sd">        representations.</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a><span class="sd">        Default is `3`.</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a><span class="sd">    columns : list[str]</span>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a><span class="sd">        Which columns to include in the table.</span>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a><span class="sd">        Default is `[&quot;equation&quot;, &quot;complexity&quot;, &quot;loss&quot;, &quot;score&quot;]`.</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a><span class="sd">    latex_table_str : str</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a><span class="sd">        A string that will render a table in LaTeX of the equations.</span>
<a id="__codelineno-0-2710" name="__codelineno-0-2710"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_latex</span><span class="p">:</span>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support latex export.&quot;</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>        <span class="p">)</span>
<a id="__codelineno-0-2715" name="__codelineno-0-2715"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>
<a id="__codelineno-0-2717" name="__codelineno-0-2717"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span>
<a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>
<a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>        <span class="n">table_string</span> <span class="o">=</span> <span class="n">sympy2multilatextable</span><span class="p">(</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a>        <span class="p">)</span>
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a>        <span class="n">table_string</span> <span class="o">=</span> <span class="n">sympy2latextable</span><span class="p">(</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<a id="__codelineno-0-2733" name="__codelineno-0-2733"></a>        <span class="p">)</span>
<a id="__codelineno-0-2734" name="__codelineno-0-2734"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2736" name="__codelineno-0-2736"></a>            <span class="s2">&quot;Invalid type for equations_ to pass to `latex_table`. &quot;</span>
<a id="__codelineno-0-2737" name="__codelineno-0-2737"></a>            <span class="s2">&quot;Expected a DataFrame or a list of DataFrames.&quot;</span>
<a id="__codelineno-0-2738" name="__codelineno-0-2738"></a>        <span class="p">)</span>
<a id="__codelineno-0-2739" name="__codelineno-0-2739"></a>
<a id="__codelineno-0-2740" name="__codelineno-0-2740"></a>    <span class="k">return</span> <span class="n">with_preamble</span><span class="p">(</span><span class="n">table_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.refresh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">refresh</span><span class="p">(</span><span class="n">run_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.refresh" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Update self.equations_ with any new options passed.</p>
<p>For example, updating <code>extra_sympy_mappings</code>
will require a <code>.refresh()</code> to update the equations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>checkpoint_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to checkpoint hall of fame file to be loaded.
The default will use the set <code>equation_file_</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2327" name="__codelineno-0-2327"></a><span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_directory</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><span class="sd">    Update self.equations_ with any new options passed.</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a><span class="sd">    For example, updating `extra_sympy_mappings`</span>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><span class="sd">    will require a `.refresh()` to update the equations.</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">    checkpoint_file : str or Path</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a><span class="sd">        Path to checkpoint hall of fame file to be loaded.</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">        The default will use the set `equation_file_`.</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a>    <span class="k">if</span> <span class="n">run_directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory_</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run_id_</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_equation_file_contents</span><span class="p">()</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a>    <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;run_id_&quot;</span><span class="p">,</span> <span class="s2">&quot;output_directory_&quot;</span><span class="p">])</span>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hof</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="expression-specifications">Expression Specifications<a class="headerlink" href="#expression-specifications" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="pysr.ExpressionSpec" class="doc doc-heading">
            <code>ExpressionSpec</code>


<a href="#pysr.ExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>The default expression specification, with no special behavior.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.TemplateExpressionSpec" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TemplateExpressionSpec</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pysr.TemplateExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>
                <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">TemplateExpressionSpec</span><span class="p">(</span><span class="n">function_symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">combine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_features</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">TemplateExpressionSpec</span><span class="p">(</span><span class="n">combine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expressions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">variable_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>                </div>


    <div class="doc doc-contents first">


        <p>Spec for templated expressions.</p>
<p>This class allows you to specify how multiple sub-expressions should be combined
in a structured way, with constraints on which variables each sub-expression can use.
Pass this to PySRRegressor with the <code>expression_spec</code> argument.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>combine</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Julia function string that defines how the sub-expressions are combined.
For example: "sin(f(x1, x2)) + g(x3)^2" would constrain f to use x1,x2 and g to use x3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expressions</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of symbols representing the inner expressions (e.g., ["f", "g"]).
These will be used as keys in the template structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_names</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variable names that will be used in the combine function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping parameter names to their lengths. For example, {"p1": 2, "p2": 1}
means p1 is a vector of length 2 and p2 is a vector of length 1. These parameters
will be optimized during the search.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Create template that combines f(x1, x2) and g(x3):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">expression_spec</span> <span class="o">=</span> <span class="n">TemplateExpressionSpec</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">variable_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;sin(f(x1, x2)) + g(x3)^2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># With parameters:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">expression_spec</span> <span class="o">=</span> <span class="n">TemplateExpressionSpec</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">variable_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;p2&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;p1[1] * sin(f(x1, x2)) + p1[2] * g(x3) + p2[1]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Use in PySRRegressor:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">expression_spec</span><span class="o">=</span><span class="n">expression_spec</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>You can also use differential operators in the template with <code>D(f, 1)(x)</code> to take
the derivative of f with respect to its first argument, evaluated at x.</p>
</details>
        <p>Handle both formats with combine as explicit parameter</p>







                  <details class="quote">
                    <summary>Source code in <code>pysr/expression_specs.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="p">):</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle both formats with combine as explicit parameter&quot;&quot;&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_old_format</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s2">&quot;function_symbols&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_format</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_load_old_format</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_load_new_format</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.ParametricExpressionSpec" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ParametricExpressionSpec</span><span class="p">(</span><span class="n">max_parameters</span><span class="p">)</span></code>

<a href="#pysr.ParametricExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Spec for parametric expressions that vary by category.</p>
<p><strong>This is deprecated in favor of the <code>TemplateExpressionSpec</code> class,
which now supports parameters indexed by category.</strong></p>
<p>This class allows you to specify expressions with parameters that vary across different
categories in your dataset. The expression structure remains the same, but parameters
are optimized separately for each category.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>max_parameters</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of parameters that can appear in the expression. Each parameter
will take on different values for each category in the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>For example, if we want to allow for a model with up to 2 parameters (each category
can have a different value for these parameters), we can use:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">expression_spec</span><span class="o">=</span><span class="n">ParametricExpressionSpec</span><span class="p">(</span><span class="n">max_parameters</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">binary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">unary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
</code></pre></div>







                  <details class="quote">
                    <summary>Source code in <code>pysr/expression_specs.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_parameters</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_parameters</span> <span class="o">=</span> <span class="n">max_parameters</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.AbstractExpressionSpec" class="doc doc-heading">
            <code>AbstractExpressionSpec</code>


<a href="#pysr.AbstractExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Abstract base class describing expression types.</p>
<p>This basically just holds the options for the expression type,
as well as explains how to parse and evaluate them.</p>
<p>All expression types must implement:</p>
<ol>
<li>julia_expression_spec(): The actual expression specification, returned as a Julia object.
    This will get passed as <code>expression_spec</code> in <code>SymbolicRegression.Options</code>.</li>
<li>create_exports(), which will be used to create the exports of the equations, such as
    the executable format, the SymPy format, etc.</li>
</ol>
<p>It may also optionally implement:</p>
<ul>
<li>supports_sympy, supports_torch, supports_jax, supports_latex: Whether this expression type supports the corresponding export format.</li>
</ul>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractExpressionSpec.create_exports" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_exports</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">equations</span><span class="p">,</span> <span class="n">search_output</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractExpressionSpec.create_exports" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create additional columns in the equations dataframe.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/expression_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_exports</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">PySRRegressor</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">equations</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">search_output</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create additional columns in the equations dataframe.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractExpressionSpec.julia_expression_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">julia_expression_spec</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractExpressionSpec.julia_expression_spec" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The expression specification</p>


            <details class="quote">
              <summary>Source code in <code>pysr/expression_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="k">def</span><span class="w"> </span><span class="nf">julia_expression_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyValue</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The expression specification&quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="logger-specifications">Logger Specifications<a class="headerlink" href="#logger-specifications" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="pysr.TensorBoardLoggerSpec" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TensorBoardLoggerSpec</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s1">&#39;logs/run&#39;</span><span class="p">,</span> <span class="n">log_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#pysr.TensorBoardLoggerSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Specification for TensorBoard logger.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>log_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where TensorBoard logs will be saved. If <code>overwrite</code> is <code>False</code>,
new logs will be saved to <code>{log_dir}_1</code>, and so on. Default is <code>"logs/run"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;logs/run&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval (in steps) at which logs are written. Default is 10.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite existing logs in the directory. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.AbstractLoggerSpec" class="doc doc-heading">
            <code>AbstractLoggerSpec</code>


<a href="#pysr.AbstractLoggerSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Abstract base class for logger specifications.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractLoggerSpec.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractLoggerSpec.close" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Close the logger instance.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/logger_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">AnyValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Close the logger instance.&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractLoggerSpec.create_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_logger</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractLoggerSpec.create_logger" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a logger instance.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/logger_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyValue</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a logger instance.&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractLoggerSpec.write_hparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_hparams</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">hparams</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractLoggerSpec.write_hparams" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Write hyperparameters to the logger.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/logger_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">write_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">AnyValue</span><span class="p">,</span> <span class="n">hparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write hyperparameters to the logger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>